(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function o(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=o(a);fetch(a.href,s)}})();const l=(e,t=document)=>t.querySelector(e);console.log("[app] loaded");(function(){let t=location.pathname.toLowerCase();t=t.replace(/\/+$/,"").replace(/\.html$/,""),(t.endsWith("/index")||t==="")&&(t="/");const o={"/":"home","/channel":"channel","/account":"account","/about":"about","/privacy":"privacy","/terms":"terms"},r=document.querySelector(`[data-nav="${o[t]}"]`);r&&r.setAttribute("aria-current","page")})();(function(){const t=l('[data-js="site-header"]'),o=l('[data-js="nav-toggle"]');!t||!o||o.addEventListener("click",()=>{const r=t.classList.toggle("is-open");o.setAttribute("aria-expanded",String(r))})})();(function(){const t=l('[data-js="site-search-form"]'),o=l("#site-search");if(!t||!o)return;const r=()=>{const a=o.value.trim();window.dispatchEvent(new CustomEvent("search:query",{detail:a}))};o.addEventListener("input",r),t.addEventListener("submit",a=>{a.preventDefault(),r()})})();const u=[{id:"abc123",title:"Clay Animation: Dawn",creatorId:"maker01",creatorName:"Maker One",category:"Animation",tags:["stopmotion","clay"],src:"/media/solo-schedule.mp4",thumbnail:"/thumbs/abc123.jpg",captions:"/captions/abc123.vtt",uploadedAt:"2025-09-28"},{id:"xyz555",title:"Analog Synth Jam",creatorId:"synth99",creatorName:"Echo Twin",category:"Music",tags:["synth","ambient"],src:"/media/solo-schedule.mp4",thumbnail:"/thumbs/xyz555.jpg",uploadedAt:"2025-09-20"}];console.log("[feed] loaded");const m=document.getElementById("feed-grid");m&&g();function g(){const e=Array.isArray(u)?u:u?.videos??[];n(p(e.slice())),document.querySelectorAll("[data-mode]").forEach(t=>{t.addEventListener("click",()=>{document.querySelectorAll("[data-mode]").forEach(r=>{r.classList.remove("is-active"),r.setAttribute("aria-pressed","false")}),t.classList.add("is-active"),t.setAttribute("aria-pressed","true");const o=t.getAttribute("data-mode");o==="random"?n(p(e.slice())):o==="chronological"?n(e.slice().sort((r,a)=>new Date(a.uploadedAt)-new Date(r.uploadedAt))):o==="subscriptions"&&n(e.filter(r=>h(r.creatorId)))})}),window.addEventListener("search:query",t=>{const o=(t.detail||"").toLowerCase();if(!o)return n(e);const r=e.filter(a=>[a.title,a.creatorName,a.category,...a.tags||[]].join(" ").toLowerCase().includes(o));n(r)})}function p(e){for(let t=e.length-1;t>0;t--){const o=Math.random()*(t+1)|0;[e[t],e[o]]=[e[o],e[t]]}return e}function n(e){if(!e||e.length===0){m.innerHTML='<p class="text-sm">No results.</p>';return}m.innerHTML=e.map(y).join("")}function h(e){try{return new Set(JSON.parse(localStorage.getItem("follows")||"[]")).has(e)}catch{return!1}}function y(e){const t=(e.tags||[]).slice(0,3).map(s=>`<span class="badge">${c(s)}</span>`).join(""),o=e.captions?'<span class="badge cc" title="Closed Captions available">CC</span>':"",r=e.thumbnail||"https://via.placeholder.co/640x360?text=Thumbnail",a=`video/${f(e.creatorName)}/${f(e.title)}`;return`
  <article class="card video"
    data-title="${i(e.title)}"
    data-creator="${i(e.creatorName)}"
    data-tags="${i((e.tags||[]).join(","))}"
    data-category="${i(e.category||"")}">
    <a class="video__link" href="${a}">
      <img class="video__thumb" src="${i(r)}" alt="${i(e.title)} â€” thumbnail" loading="lazy">
      <div class="video__meta">
        <h3 class="video__title">${c(e.title)}</h3>
        <p class="video__creator">${c(e.creatorName)}</p>
        <div class="video__tags">
          <span class="badge">${c(e.category||"General")}</span>
          ${t}${o}
        </div>
      </div>
    </a>
  </article>`}function f(e){return String(e).toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")}function c(e){return String(e).replace(/[&<>"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"})[t])}function i(e){return c(e).replace(/"/g,"&quot;")}
